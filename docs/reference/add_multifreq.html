<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Add multi-letter information to a motif. — add_multifreq • universalmotif</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Add multi-letter information to a motif. — add_multifreq" />

<meta property="og:description" content="If the original sequences are available for a particular motif, then they
can be used to generate higher-order PPM matrices." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">universalmotif</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/AdvancedUsage.html">Advanced motif and sequence manipulation</a>
    </li>
    <li>
      <a href="../articles/Introduction.html">Introduction to the "universalmotif" package</a>
    </li>
    <li>
      <a href="../articles/IntroductionToSequenceMotifs.html">Introduction to sequence motifs</a>
    </li>
    <li>
      <a href="../articles/MotifManipulation.html">Motif import, export, visualization, and manipulation</a>
    </li>
    <li>
      <a href="../articles/SequenceSearches.html">Sequence creation, manipulation, and scanning</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/bjmt/universalmotif">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Add multi-letter information to a motif.</h1>
    <small class="dont-index">Source: <a href='https://github.com/bjmt/universalmotif/blob/master/R/add_multifreq.R'><code>R/add_multifreq.R</code></a></small>
    <div class="hidden name"><code>add_multifreq.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>If the original sequences are available for a particular motif, then they
can be used to generate higher-order PPM matrices.</p>
    
    </div>

    <pre class="usage"><span class='fu'>add_multifreq</span>(<span class='no'>motif</span>, <span class='no'>sequences</span>, <span class='kw'>add.k</span> <span class='kw'>=</span> <span class='fl'>2</span>:<span class='fl'>3</span>, <span class='kw'>RC</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>threshold</span> <span class='kw'>=</span> <span class='fl'>0.01</span>, <span class='kw'>threshold.type</span> <span class='kw'>=</span> <span class='st'>"logodds"</span>, <span class='kw'>motifs.perseq</span> <span class='kw'>=</span> <span class='fl'>1</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>motif</th>
      <td><p>See <code><a href='convert_motifs.html'>convert_motifs()</a></code> for acceptable formats. If the
motif is not a <a href='universalmotif-class.html'>universalmotif</a> motif, then it will be
converted.</p></td>
    </tr>
    <tr>
      <th>sequences</th>
      <td><p><a href='http://www.rdocumentation.org/packages/Biostrings/topics/XStringSet-class'>Biostrings::XStringSet</a> The alphabet must match
that of the motif. If
these sequences are all the same length as the motif, then they are all
used to generate the multi-freq matrices. Otherwise
<code><a href='scan_sequences.html'>scan_sequences()</a></code> is first run to find the right sequence.</p></td>
    </tr>
    <tr>
      <th>add.k</th>
      <td><p><code>numeric(1)</code> The k-let lengths to add.</p></td>
    </tr>
    <tr>
      <th>RC</th>
      <td><p><code>logical(1)</code> Check the reverse complement of a DNA sequence.
See <code><a href='scan_sequences.html'>scan_sequences()</a></code>.</p></td>
    </tr>
    <tr>
      <th>threshold</th>
      <td><p><code>numeric(1)</code> Between 0 and 1. See <code><a href='scan_sequences.html'>scan_sequences()</a></code>.</p></td>
    </tr>
    <tr>
      <th>threshold.type</th>
      <td><p><code>character(1)</code> One of <code>c('logodds', 'pvalue')</code>.
See <code><a href='scan_sequences.html'>scan_sequences()</a></code>.</p></td>
    </tr>
    <tr>
      <th>motifs.perseq</th>
      <td><p><code>numeric(1)</code> If <code><a href='scan_sequences.html'>scan_sequences()</a></code> is run,
then this indicates how many hits from each sequence is to be used.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <a href='universalmotif-class.html'>universalmotif</a> object with filled <code>multifreq</code> slot.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>At each position in the motif, then the probability of each k-let
covering from the initial position to ncol - 1 is calculated. Only
positions within the motif are considered; this means that the
final k-let probability matrix will have ncol - 1 fewer columns.
Calculating k-let probabilities for the missing columns would be
trivial however, as you would only need the background frequencies.
Since these would not be useful for <code><a href='scan_sequences.html'>scan_sequences()</a></code>
though, they are not calculated.</p>
<p>Currently <code>add_multifreq()</code> does not try to stay faithful to the default
motif matrix when generating multifreq matrices. This means that if the
sequences used for training are completely different from the actual
motif, the multifreq matrices will be as well. However this is only really
a problem if you supply <code>add_multifreq()</code> with a set of sequences of the
same length as the motif; in this case <code>add_multifreq()</code> is forced to
create the multifreq matrices from these sequences. Otherwise
<code>add_multifreq()</code> will scan the input sequences for the motif and use the
best matches to construct the multifreq matrices.</p>
<p>This 'multifreq' representation is only really useful within the
<span class="pkg">universalmotif</span> enrivonment. Despite this, if you wish it can be
preserved in text using <code><a href='write_motifs.html'>write_motifs()</a></code>.</p>
<p>Note: the number of rows for each k-let matrix is n^k, with n being the
number of letters in the alphabet being used. This means that the size
of the k-let matrix can become quite large as k increases. For example,
if one were to wish to represent a DNA motif of length 10 as a 10-let,
this would require a matrix with 1,048,576 rows (though at this point
if what you want is to search for exact sequence matches,
the motif format itself is not very useful).</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='scan_sequences.html'>scan_sequences()</a></code>, <code><a href='convert_motifs.html'>convert_motifs()</a></code>, <code><a href='write_motifs.html'>write_motifs()</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>sequences</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='create_sequences.html'>create_sequences</a></span>(<span class='kw'>seqlen</span> <span class='kw'>=</span> <span class='fl'>10</span>)
<span class='no'>motif</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='create_motif.html'>create_motif</a></span>()
<span class='no'>motif.trained</span> <span class='kw'>&lt;-</span> <span class='fu'>add_multifreq</span>(<span class='no'>motif</span>, <span class='no'>sequences</span>, <span class='kw'>add.k</span> <span class='kw'>=</span> <span class='fl'>2</span>:<span class='fl'>4</span>)
<span class='co'>## peek at the 2-let matrix:</span>
<span class='no'>motif.trained</span>[<span class='st'>"multifreq"</span>]$<span class='no'>`2`</span></div><div class='output co'>#&gt;       1    2    3    4    5    6    7    8    9
#&gt; AA 0.08 0.04 0.03 0.07 0.04 0.03 0.06 0.07 0.08
#&gt; AC 0.09 0.10 0.05 0.07 0.10 0.05 0.08 0.09 0.08
#&gt; AG 0.07 0.08 0.02 0.06 0.10 0.06 0.04 0.01 0.05
#&gt; AT 0.07 0.06 0.04 0.05 0.09 0.07 0.10 0.09 0.07
#&gt; CA 0.09 0.01 0.11 0.12 0.05 0.12 0.04 0.10 0.03
#&gt; CC 0.05 0.08 0.06 0.04 0.07 0.03 0.05 0.05 0.06
#&gt; CG 0.02 0.05 0.05 0.09 0.06 0.07 0.06 0.05 0.09
#&gt; CT 0.03 0.09 0.13 0.03 0.03 0.07 0.06 0.07 0.08
#&gt; GA 0.04 0.02 0.04 0.06 0.09 0.08 0.08 0.05 0.06
#&gt; GC 0.03 0.08 0.08 0.02 0.08 0.07 0.07 0.09 0.03
#&gt; GG 0.06 0.02 0.04 0.07 0.07 0.07 0.05 0.03 0.01
#&gt; GT 0.14 0.08 0.07 0.03 0.07 0.04 0.06 0.05 0.04
#&gt; TA 0.07 0.07 0.07 0.08 0.03 0.05 0.08 0.06 0.10
#&gt; TC 0.06 0.09 0.09 0.08 0.04 0.06 0.07 0.03 0.09
#&gt; TG 0.05 0.08 0.07 0.09 0.03 0.06 0.07 0.05 0.06
#&gt; TT 0.05 0.05 0.05 0.04 0.05 0.07 0.03 0.11 0.07</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Benjamin Tremblay, <a href='mailto:b2tremblay@uwaterloo.ca'>b2tremblay@uwaterloo.ca</a>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Benjamin Tremblay.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

